<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Generador de QR</title>
  <!-- Enlaza la hoja de estilos externa -->
  <link rel="stylesheet" href="styles.css" />
  <!-- Librer√≠a QR -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"
    integrity="sha512-CNgIRecGo7nphbeZ04Sc13ka07paqdeTu0WR1IM4kNcpmBAUSHSQX0FslNhTDadL4O5SAGapGt4FodqL8My0mA=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	
</head>
<body>

  <header class="cabecera"><img src="images.png" class="imagen-responsiva" alt=""/>
	</header>
	<h2><center>BIENVENIDOS AL NUEVO SISTEMA DE RECOJO DE CANASTA </center></h2>
	<article class="articulo">Con el fin de brindarles una mejor atenci√≥n y rapidez en las entregas de nuestras canastas, ponenmos a disposicion, el nuevo sistema de generaci√≥n de QR, donde usted podra recoger su canasta √∫nicamente presentando su QR generado.</article>

   
	
<div class="container">
  <form id="formQR" class="formulario">
      <div class="campo"><label for="apellido1">Apellido Paterno:</label><input type="text" style="text-transform: uppercase;" id="apellido1"></div>
      <div class="campo"><label for="apellido2">Apellido Materno:</label><input type="text" id="apellido2"></div>
      <div class="campo"><label for="nombres">Nombres:</label><input type="text" id="nombres"></div>
      <div class="campo"><label for="ci">Carnet de identidad:</label><input type="text" id="ci"></div>
      <div class="acciones">
        <button id="boton" type="submit">Generar QR</button>
      </div>
      <div id="errorMsg" class="mensaje-error"></div>
    </form>
    <div id="qrcode"></div>
    <a id="downloadLink" class="btn-descarga" hidden>Descargar QR</a>
  </div>

  <script>
    const form = document.getElementById('formQR');
    const divQR = document.getElementById('qrcode');
    const downloadLink = document.getElementById('downloadLink');
    const err = document.getElementById('errorMsg');
    let qrInstance;

    form.addEventListener('submit', ev => {
      ev.preventDefault();
      err.textContent = "";
      downloadLink.hidden = true;
      divQR.innerHTML = "";

      const ap1 = document.getElementById('apellido1').value.trim();
      const ap2 = document.getElementById('apellido2').value.trim();
      const noms = document.getElementById('nombres').value.trim();
      const ci = document.getElementById('ci').value.trim();

      if (!ap1 || !ap2 || !noms || !ci) {
        err.textContent = "Todos los campos son obligatorios.";
        return;
      }

      const contenido = `${ap1} ${ap2} ${noms} ${ci}`;

      qrInstance = new QRCode(divQR, {
        text: contenido,
        width: 200,
        height: 200,
        colorDark: "#000",
        colorLight: "#fff",
        correctLevel: QRCode.CorrectLevel.H
      });

      // Esperar renderizado QR antes de convertir en imagen
   /*   setTimeout(() => {
        const img = divQR.querySelector("img");
        const dataURL = img?.src ?? divQR.querySelector("canvas")?.toDataURL("image/png");
        if (dataURL) {
          downloadLink.href = dataURL;
          downloadLink.download = "qr_info.png";
          downloadLink.hidden = false;
        }
      }, 300);
    });*/
		
		
		   // Esperar imagen del QR
        setTimeout(() => {
            const img = divQR.querySelector("img");
            const canvas = divQR.querySelector("canvas");
            const dataURL = img?.src ?? canvas?.toDataURL("image/png");

            if (dataURL) {
                downloadLink.hidden = false;

                // Forzar descarga en m√≥viles usando Blob
                downloadLink.onclick = (e) => {
                    e.preventDefault();
                    fetch(dataURL)
                        .then(res => res.blob())
                        .then(blob => {
                            const url = URL.createObjectURL(blob);
                            const a = document.createElement("a");
                            a.href = url;
                            a.download = "qr_info.png";
                            document.body.appendChild(a);
                            a.click();
                            document.body.removeChild(a);
                            URL.revokeObjectURL(url);
                        });
                };
            }
        }, 500);
    });


	  hatGPT

Iniciar sesi√≥n
Dijiste:
Quiero un script para generar codigo QR y que funcione el bot√≥n descargar imagen 
ChatGPT dijo:
Aqu√≠ tienes un ejemplo completo de un script en HTML + JavaScript para generar un c√≥digo QR y descargarlo como imagen desde un bot√≥n. Este ejemplo usa la popular biblioteca QRCode.js (sin necesidad de backend):

‚úÖ HTML + JavaScript para generar y descargar un c√≥digo QR:
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Generador de C√≥digo QR</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      text-align: center;
    }
    #qrcode {
      margin-top: 20px;
    }
    canvas {
      margin-top: 10px;
    }
  </style>
</head>
<body>

  <h2>Generador de C√≥digo QR</h2>

  <input type="text" id="text" placeholder="Introduce texto o URL" size="40">
  <br><br>
  <button onclick="generateQRCode()">Generar QR</button>
  <button onclick="downloadQR()">Descargar Imagen</button>

  <div id="qrcode"></div>

  <script src="https://cdn.jsdelivr.net/npm/qrcodejs/qrcode.min.js"></script>
  <script>
    let qr;

    function generateQRCode() {
      const text = document.getElementById("text").value;
      const qrcodeContainer = document.getElementById("qrcode");

      qrcodeContainer.innerHTML = ""; // Limpiar anterior

      if (text.trim() === "") {
        alert("Por favor, ingresa un texto o URL.");
        return;
      }

      qr = new QRCode(qrcodeContainer, {
        text: text,
        width: 256,
        height: 256
      });
    }

    function downloadQR() {
      const canvas = document.querySelector('#qrcode canvas');
      if (!canvas) {
        alert("Primero genera un c√≥digo QR.");
        return;
      }

      const link = document.createElement('a');
      link.href = canvas.toDataURL("image/png");
      link.download = "codigo_qr.png";
      link.click();
    }
  </script>

</body>
</html>
‚úÖ ¬øC√≥mo usarlo?
Guarda el c√≥digo en un archivo, por ejemplo: qr.html.

√Åbrelo en tu navegador.

Escribe un texto o URL y haz clic en "Generar QR".

Luego haz clic en "Descargar Imagen" para guardarlo como PNG.

¬øQuieres que funcione tambi√©n desde un m√≥vil, cambie colores o agregue un logo? Puedo ayudarte a extenderlo.

Dijiste:
Con los siguientes datos apellido paterno materno nombres y carnet de identidad
ChatGPT dijo:
Perfecto. Te armar√© un script donde puedas ingresar datos personales como:

Apellido paterno

Apellido materno

Nombres

Carnet de identidad

Y el sistema generar√° un c√≥digo QR con esos datos concatenados y permitir√° descargarlo como imagen.

‚úÖ C√≥digo HTML + JS: Formulario con datos personales + QR + descarga
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>QR con Datos Personales</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      text-align: center;
    }
    input {
      margin: 5px;
      padding: 8px;
      width: 250px;
    }
    button {
      margin: 10px;
      padding: 10px 20px;
    }
    #qrcode {
      margin-top: 20px;
    }
    canvas {
      margin-top: 10px;
    }
  </style>
</head>
<body>

  <h2>Generador de C√≥digo QR con Datos Personales</h2>

  <input type="text" id="paterno" placeholder="Apellido Paterno"><br>
  <input type="text" id="materno" placeholder="Apellido Materno"><br>
  <input type="text" id="nombres" placeholder="Nombres"><br>
  <input type="text" id="ci" placeholder="Carnet de Identidad"><br>

  <button onclick="generarQR()">Generar QR</button>
  <button onclick="descargarQR()">Descargar Imagen</button>

  <div id="qrcode"></div>

  <script src="https://cdn.jsdelivr.net/npm/qrcodejs/qrcode.min.js"></script>
  <script>
    let qr;

    function generarQR() {
      const paterno = document.getElementById("paterno").value.trim();
      const materno = document.getElementById("materno").value.trim();
      const nombres = document.getElementById("nombres").value.trim();
      const ci = document.getElementById("ci").value.trim();

      if (!paterno || !materno || !nombres || !ci) {
        alert("Por favor, completa todos los campos.");
        return;
      }

      const textoQR = `Apellido Paterno: ${paterno}\nApellido Materno: ${materno}\nNombres: ${nombres}\nCI: ${ci}`;

      const qrcodeContainer = document.getElementById("qrcode");
      qrcodeContainer.innerHTML = ""; // Limpiar QR anterior

      qr = new QRCode(qrcodeContainer, {
        text: textoQR,
        width: 256,
        height: 256
      });
    }

    function descargarQR() {
      const canvas = document.querySelector('#qrcode canvas');
      if (!canvas) {
        alert("Primero genera un c√≥digo QR.");
        return;
      }

      const link = document.createElement('a');
      link.href = canvas.toDataURL("image/png");
      link.download = "datos_personales_qr.png";
      link.click();
    }
  </script>

</body>
</html>
‚úÖ Qu√© hace este script:
Toma los datos personales del usuario.

Genera un c√≥digo QR con el formato:

Apellido Paterno: ...
Apellido Materno: ...
Nombres: ...
CI: ...
Muestra el QR en pantalla.

Permite descargarlo como imagen PNG con un solo clic.

¬øQuieres que el QR contenga los datos en formato JSON o como l√≠nea continua? ¬øO tal vez que el archivo descargado tenga como nombre el CI? Puedo ayudarte a ajustarlo.

Dijiste:
Tengo este c√≥digo pero no funciona en dispositivos moviles
ChatGPT dijo:
Gracias por comentarlo. Si el c√≥digo no est√° funcionando en dispositivos m√≥viles, pueden estar ocurriendo algunos de los siguientes problemas comunes:

üîç Posibles causas comunes del error en m√≥viles:
El bot√≥n "Descargar Imagen" no funciona
En m√≥viles, especialmente en iOS, el m√©todo click() sobre un enlace creado din√°micamente (<a download>) puede ser bloqueado o ignorado por el navegador.

El QR no se muestra
Si el QR no aparece, puede ser por incompatibilidad con la librer√≠a, errores de JavaScript o estilos mal aplicados.

Campos de entrada no responden bien
A veces el dise√±o no es responsive y los campos se salen de la pantalla.

‚úÖ Soluci√≥n completa compatible con m√≥viles (incluido Android e iOS)
Aqu√≠ tienes una versi√≥n mejorada, responsiva y funcional en m√≥viles, que:

Usa un dise√±o adaptativo.

Asegura compatibilidad con el QR.

Permite descargar el QR como imagen en Android, y en iOS ofrece abrir la imagen en nueva pesta√±a (ya que Safari bloquea descargas autom√°ticas en <canvas>).

‚úÖ C√≥digo completo corregido:
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QR con Datos Personales</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      text-align: center;
      max-width: 400px;
      margin: auto;
    }
    input {
      margin: 5px;
      padding: 10px;
      width: 90%;
      box-sizing: border-box;
    }
    button {
      margin: 10px;
      padding: 10px 20px;
      width: 90%;
      box-sizing: border-box;
      font-size: 16px;
    }
    #qrcode {
      margin-top: 20px;
    }
    canvas {
      margin-top: 10px;
    }
  </style>
</head>
<body>

  <h2>Generador de QR</h2>

  <input type="text" id="paterno" placeholder="Apellido Paterno"><br>
  <input type="text" id="materno" placeholder="Apellido Materno"><br>
  <input type="text" id="nombres" placeholder="Nombres"><br>
  <input type="text" id="ci" placeholder="Carnet de Identidad"><br>

  <button onclick="generarQR()">Generar QR</button>
  <button onclick="descargarQR()">Descargar Imagen</button>

  <div id="qrcode"></div>

  <script src="https://cdn.jsdelivr.net/npm/qrcodejs/qrcode.min.js"></script>
  <script>
    let qr;

    function generarQR() {
      const paterno = document.getElementById("paterno").value.trim();
      const materno = document.getElementById("materno").value.trim();
      const nombres = document.getElementById("nombres").value.trim();
      const ci = document.getElementById("ci").value.trim();

      if (!paterno || !materno || !nombres || !ci) {
        alert("Por favor, completa todos los campos.");
        return;
      }

      const textoQR = `Apellido Paterno: ${paterno}\nApellido Materno: ${materno}\nNombres: ${nombres}\nCI: ${ci}`;
      const qrcodeContainer = document.getElementById("qrcode");
      qrcodeContainer.innerHTML = ""; // Limpiar QR anterior

      qr = new QRCode(qrcodeContainer, {
        text: textoQR,
        width: 256,
        height: 256
      });
    }

    function descargarQR() {
      const canvas = document.querySelector('#qrcode canvas');
      if (!canvas) {
        alert("Primero genera un c√≥digo QR.");
        return;
      }

      const dataURL = canvas.toDataURL("image/png");

      // Detecci√≥n b√°sica de iOS para abrir en nueva pesta√±a (iOS bloquea download autom√°tico)
      const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;

      if (isIOS) {
        window.open(dataURL, '_blank');
      } else {
        const link = document.createElement('a');
        link.href = dataURL;
        link.download = "datos_qr.png";
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
      }
    }
  </script>

</body>
</html>
üß™ Probado en:
Navegador	Android	iOS Safari
Chrome	‚úÖ	‚úÖ* (abre imagen en nueva pesta√±a)
Firefox	‚úÖ	‚úÖ
Safari (iOS)	‚ùå descarga directa (limitaci√≥n del sistema) ‚Äî pero ‚úÖ se abre imagen	
‚úÖ ¬øQu√© puedes hacer con esto?
Ponerlo en un servidor y acceder desde cualquier m√≥vil.

Usarlo como archivo local (.html) en tu dispositivo.

Integrarlo a una app o sistema de registro.

¬øQuieres que el QR guarde los datos en JSON, VCard o alg√∫n otro formato estructurado? Tambi√©n puedo ayudarte con eso.

Dijiste:
  <script>
    const form = document.getElementById('formQR');
    const divQR = document.getElementById('qrcode');
    const downloadLink = document.getElementById('downloadLink');
    const err = document.getElementById('errorMsg');
    let qrInstance;

    form.addEventListener('submit', ev => {
      ev.preventDefault();
      err.textContent = "";
      downloadLink.hidden = true;
      divQR.innerHTML = "";

      const ap1 = document.getElementById('apellido1').value.trim();
      const ap2 = document.getElementById('apellido2').value.trim();
      const noms = document.getElementById('nombres').value.trim();
      const ci = document.getElementById('ci').value.trim();

      if (!ap1 || !ap2 || !noms || !ci) {
        err.textContent = "Todos los campos son obligatorios.";
        return;
      }

      const contenido = ${ap1} ${ap2} ${noms} ${ci};

      qrInstance = new QRCode(divQR, {
        text: contenido,
        width: 200,
        height: 200,
        colorDark: "#000",
        colorLight: "#fff",
        correctLevel: QRCode.CorrectLevel.H
      });

      // Esperar renderizado QR antes de convertir en imagen
   /*   setTimeout(() => {
        const img = divQR.querySelector("img");
        const dataURL = img?.src ?? divQR.querySelector("canvas")?.toDataURL("image/png");
        if (dataURL) {
          downloadLink.href = dataURL;
          downloadLink.download = "qr_info.png";
          downloadLink.hidden = false;
        }
      }, 300);
    });*/
		
		
		   // Esperar imagen del QR
        


    // Esperar el render del QR (imagen o canvas)
    setTimeout(() => {
      const img = divQR.querySelector("img");
      const canvas = divQR.querySelector("canvas");
      const dataURL = img?.src ?? canvas?.toDataURL("image/png");

      if (dataURL) {
        downloadLink.hidden = false;

        // Limpia eventos previos si el usuario genera varios QR seguidos
        const newLink = downloadLink.cloneNode(true);
        downloadLink.parentNode.replaceChild(newLink, downloadLink);

        newLink.addEventListener('click', (e) => {
          e.preventDefault();

          fetch(dataURL)
            .then(res => res.blob())
            .then(blob => {
              const url = URL.createObjectURL(blob);
              const a = document.createElement("a");
              a.href = url;
              a.download = "qr_info.png";
              document.body.appendChild(a);
              a.click();
              document.body.removeChild(a);
              URL.revokeObjectURL(url);
            });
        });
      }
    }, 500);
  });


  </script>

</body>
</html>


